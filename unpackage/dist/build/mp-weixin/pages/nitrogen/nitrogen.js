(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/nitrogen/nitrogen"],{"24a0":function(e,t,a){"use strict";var n=a("6f6a"),o=a.n(n);o.a},"5ebb":function(e,t,a){"use strict";a.r(t);var n=a("e4e0"),o=a("e8ec");for(var r in o)"default"!==r&&function(e){a.d(t,e,(function(){return o[e]}))}(r);a("24a0");var i,c=a("f0c5"),u=Object(c["a"])(o["default"],n["b"],n["c"],!1,null,"68e9c6a4",null,!1,n["a"],i);t["default"]=u.exports},"6f6a":function(e,t,a){},d8ed:function(e,t,a){"use strict";(function(e){a("fae7");n(a("66fd"));var t=n(a("5ebb"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("543d")["createPage"])},e4e0:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return n}));var n={qiunDataCharts:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/qiun-data-charts/components/qiun-data-charts/qiun-data-charts")]).then(a.bind(null,"a084c"))}},o=function(){var e=this,t=e.$createElement,a=(e._self._c,e.flagIsRunning?e.data_1.o2.toFixed(2):null),n=e.flagIsRunning?e.data_1.co2.toFixed(2):null,o=e.flagIsRunning?e.data_1.ph3.toFixed(2):null,r=e.flagIsRunning?e.__map(Object.keys(e.dataPoints),(function(t,a){var n=e.__get_orig(t),o=e.dataPoints[t].o2.toFixed(2),r=e.dataPoints[t].co2.toFixed(2),i=e.dataPoints[t].n2.toFixed(2),c=e.dataPoints[t].ph3.toFixed(2);return{$orig:n,g3:o,g4:r,g5:i,g6:c}})):null;e._isMounted||(e.e0=function(t){e.modalName="DialogModal1"}),e.$mp.data=Object.assign({},{$root:{g0:a,g1:n,g2:o,l0:r}})},r=[]},e608:function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(a("a34a"));function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t,a,n,o,r,i){try{var c=e[r](i),u=c.value}catch(s){return void a(s)}c.done?t(u):Promise.resolve(u).then(n,o)}function i(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function c(e){r(i,n,o,c,u,"next",e)}function u(e){r(i,n,o,c,u,"throw",e)}c(void 0)}))}}var c={data:function(){return{flagNewUser:!0,username:"",modalName:null,flagIsRunning:!1,flagIsAirChecking:!1,flagIsNitrogenRunning:!1,productKey:void 0,devKeyNitrogen:void 0,devKeyAirCheck:void 0,devKeyHardware:void 0,devKeyGas:void 0,devKeyPressure:void 0,devKeyBug:void 0,dataTable:[],dataForm:{n2Way:0,targetN2:void 0},dataPoints:{1:{name:"空间监测点",o2:"-",co2:"-",n2:"-",ph3:"-"},33:{name:"测试点1",o2:"-",co2:"-",n2:"-",ph3:"-"},34:{name:"测试点2",o2:"-",co2:"-",n2:"-",ph3:"-"},35:{name:"测试点3",o2:"-",co2:"-",n2:"-",ph3:"-"},36:{name:"测试点4",o2:"-",co2:"-",n2:"-",ph3:"-"},37:{name:"测试点5",o2:"-",co2:"-",n2:"-",ph3:"-"},38:{name:"测试点6",o2:"-",co2:"-",n2:"-",ph3:"-"},39:{name:"测试点7",o2:"-",co2:"-",n2:"-",ph3:"-"},40:{name:"测试点8",o2:"-",co2:"-",n2:"-",ph3:"-"}},dataPressure:0,dataBug:0,data_1:{n2:0,o2:0,co2:0,ph3:0},timer:0,chartData:{categories:[{value:1,color:"#1890FF"}],series:[{name:"完成率",data:.66}]},options:{type:"gauge",canvasId:"",canvas2d:!1,background:"none",animation:!0,timing:"easeOut",duration:1e3,color:["#1890FF","#91CB74","#FAC858","#EE6666","#73C0DE","#3CA272","#9A60B4","#ea7ccc"],rotate:!1,errorReload:!0,fontSize:10,fontColor:"#666666",enableScroll:!1,touchMoveLimit:60,enableMarkLine:!1,dataLabel:!0,dataPointShape:!0,dataPointShapeType:"solid",tapLegend:!0,title:{name:"20Pa",fontSize:18,color:"#000000",offsetX:0,offsetY:50},subtitle:{name:"氮气浓度",fontSize:10,color:"#000000",offsetX:0,offsetY:-45},extra:{gauge:{type:"default",width:13,labelColor:"#666666",labelOffset:13,startAngle:.75,endAngle:.25,startNumber:0,endNumber:100,format:"",splitLine:{fixRadius:0,splitNumber:10,width:30,color:"#FFFFFF",childNumber:5,childWidth:5},pointer:{width:15,color:"1890FF"},labelFormat:""}}},chartData2:{categories:[{value:1,color:"#1890FF"}],series:[{name:"完成率",data:.9}]},options2:{type:"gauge",canvasId:"",canvas2d:!1,background:"none",animation:!0,timing:"easeOut",duration:1e3,color:["#1890FF","#91CB74","#FAC858","#EE6666","#73C0DE","#3CA272","#9A60B4","#ea7ccc"],rotate:!1,errorReload:!0,fontSize:10,fontColor:"#666666",enableScroll:!1,touchMoveLimit:60,enableMarkLine:!1,dataLabel:!0,dataPointShape:!0,dataPointShapeType:"solid",tapLegend:!0,title:{name:"20Pa",fontSize:18,color:"#000000",offsetX:0,offsetY:50},subtitle:{name:"仓内压力",fontSize:10,color:"#000000",offsetX:0,offsetY:-45},extra:{gauge:{type:"default",width:13,labelColor:"#666666",labelOffset:13,startAngle:.75,endAngle:.25,startNumber:-400,endNumber:400,format:"",splitLine:{fixRadius:0,splitNumber:10,width:30,color:"#FFFFFF",childNumber:5,childWidth:5},pointer:{width:15,color:"1890FF"},labelFormat:""}}}}},onLoad:function(){},onShow:function(){this.username=e.getStorageSync("username_nitrogen"),this.flagNewUser&&(this.start(),this.flagNewUser=!1)},onPullDownRefresh:function(){this.getGasPreData()},methods:{start:function(){var t=this;return i(n.default.mark((function a(){var o,r,i;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.showLoading(),a.next=3,t.$api.getProduct();case 3:if(o=a.sent,200===o.code){a.next=6;break}return a.abrupt("return",e.hideLoading());case 6:if(r=o.data.productInfo.find((function(e){return"N2"===e.typeIdentify})),r){a.next=11;break}return t.$message("您未安装相关制氮设备",3),e.hideLoading(),a.abrupt("return");case 11:return t.productKey=r.productKey,a.next=14,t.$api.getDeviceList(r.productKey);case 14:if(i=a.sent,200===i.code){a.next=17;break}return a.abrupt("return");case 17:i.data.deviceInfo.forEach((function(e){switch(e.deviceType){case"N2":t.devKeyNitrogen=e.deviceKey;break;case"airCheck":t.devKeyAirCheck=e.deviceKey;break;case"hardware":t.devKeyHardware=e.deviceKey;break;case"xc-air":t.devKeyGas=e.deviceKey;break;case"xc-pressure":t.devKeyPressure=e.deviceKey;break;case"xc-bug":t.devKeyBug=e.deviceKey;break}})),t.getGasPreData(),t.getAirCheckStatus(),t.getNitrogenStatus();case 21:case"end":return a.stop()}}),a)})))()},getHardwareStatus:function(){var e=this;return i(n.default.mark((function t(){var a,o,r;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={productKey:e.productKey,deviceKey:e.devKeyHardware,extraInfo:{key:"n2status",Value:["open","close"]}},t.next=3,e.$api.getDeviceStatusExtra(a);case 3:o=t.sent,console.log(o),r=!0,e.flagIsRunning=r,console.log("设备组状态："+e.flagIsRunning),e.flagIsRunning&&e.getGasPreData();case 9:case"end":return t.stop()}}),t)})))()},getAirCheckStatus:function(){var e=this;return i(n.default.mark((function t(){var a,o;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={productKey:e.productKey,deviceKey:e.devKeyAirCheck,extraInfo:{key:"n2status",Value:["airTeststart","airTestendWitherr","airTestendWithOK"]}},t.next=3,e.$api.getDeviceStatusExtra(a);case 3:o=t.sent,20010===o.code?(e.flagIsAirChecking=!1,console.log("气密性状态："+!1)):200===o.code&&(["airTestendWitherr","airTestendWithOK"].includes(o.data.data.extraInfo.n2status.Value)?e.flagIsAirChecking=!1:e.flagIsAirChecking=!0,console.log("气密性状态："+o.data.data.extraInfo.n2status.Value));case 5:case"end":return t.stop()}}),t)})))()},getNitrogenStatus:function(){var e=this;return i(n.default.mark((function t(){var a,o;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={productKey:e.productKey,deviceKey:e.devKeyNitrogen,extraInfo:{key:"n2status",Value:["open","close"]}},t.next=3,e.$api.getDeviceStatusExtra(a);case 3:if(o=t.sent,200===o.code){t.next=7;break}return e.$message(o.msg),t.abrupt("return");case 7:"open"===o.data.data.extraInfo.n2status.Value?e.flagIsNitrogenRunning=!0:e.flagIsNitrogenRunning=!1,e.getNitrogenData(),console.log("制氮机状态："+o.data.data.extraInfo.n2status.Value);case 10:case"end":return t.stop()}}),t)})))()},getNitrogenData:function(){var e=this;return i(n.default.mark((function t(){var a,o,r;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.getRecentData(e.productKey,e.devKeyNitrogen,10);case 2:if(a=t.sent,200===a.code){t.next=6;break}return e.$message("获取制氮机数据失败"),t.abrupt("return");case 6:o=a.data.deviceData.find((function(e){return e.data&&"chundu"in e.data})),r={deviceKey:o.deviceKey,deviceName:"制氮机1号",chundu:o.data.chundu,liuliang:o.data.liuliang,yali:o.data.yali},e.dataTable=[r];case 9:case"end":return t.stop()}}),t)})))()},getGasPreData:function(){var t=this;return i(n.default.mark((function a(){var o,r,i,c,u,s,d,l,f,g,p;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("获取压力气体数据..."),a.next=3,t.$api.getRecentData(t.productKey,t.devKeyHardware,50);case 3:if(o=a.sent,setTimeout((function(){t.$message("刷新成功"),e.stopPullDownRefresh()}),500),e.hideLoading(),200===o.code){a.next=8;break}return a.abrupt("return");case 8:if(r=o.data.deviceData.find((function(e){if("time"in e&&!isNaN(parseInt(e.time)))return!0})),!r){a.next=19;break}if(i=Date.now(),!(i-r.time<6e5)){a.next=16;break}t.flagIsRunning=!0,console.log("设备组状态："+!0),a.next=19;break;case 16:return t.flagIsRunning=!1,console.log("设备组状态："+!1),a.abrupt("return");case 19:c="-",u=0,s=0,d=0,l=0,f=0,g={1:{name:"空间监测点",o2:"-",co2:"-",n2:"-",ph3:"-"},33:{name:"测试点1",o2:"-",co2:"-",n2:"-",ph3:"-"},34:{name:"测试点2",o2:"-",co2:"-",n2:"-",ph3:"-"},35:{name:"测试点3",o2:"-",co2:"-",n2:"-",ph3:"-"},36:{name:"测试点4",o2:"-",co2:"-",n2:"-",ph3:"-"},37:{name:"测试点5",o2:"-",co2:"-",n2:"-",ph3:"-"},38:{name:"测试点6",o2:"-",co2:"-",n2:"-",ph3:"-"},39:{name:"测试点7",o2:"-",co2:"-",n2:"-",ph3:"-"},40:{name:"测试点8",o2:"-",co2:"-",n2:"-",ph3:"-"}},o.data.deviceData.forEach((function(e){"o2"in e&&"-"===g[e.kzqNo].n2?(g[e.kzqNo].n2=e.n2,g[e.kzqNo].o2=e.o2,g[e.kzqNo].co2=e.co2,g[e.kzqNo].ph3=0,u+=e.n2,s+=e.o2,d+=e.co2,f++):"in_Pa"in e&&"-"===c&&(c=e.in_Pa,t.options2.title.name=e.in_Pa+"Pa",t.chartData2.series[0].data=(e.in_Pa+400)/800)})),t.dataPoints=g,console.log(g),t.dataPressure="-"!==c?c:0,p={n2:0,o2:0,co2:0,ph3:0},0!==f?(p.n2=parseFloat((u/f).toFixed(1)),p.o2=parseFloat((s/f).toFixed(1)),p.co2=parseFloat((d/f).toFixed(1)),p.ph3=parseFloat((l/f).toFixed(1))):(p.n2=0,p.o2=0,p.co2=0,p.ph3=0),t.data_1=p,t.options.title.name=p.n2+"%",t.chartData.series[0].data=parseFloat(p.n2)/100,setTimeout((function(){}));case 36:case"end":return a.stop()}}),a)})))()},hideModal:function(){this.modalName=null},logout:function(){this.flagNewUser=!0,this.modalName=null,e.reLaunch({url:"../login"})}}};t.default=c}).call(this,a("543d")["default"])},e8ec:function(e,t,a){"use strict";a.r(t);var n=a("e608"),o=a.n(n);for(var r in n)"default"!==r&&function(e){a.d(t,e,(function(){return n[e]}))}(r);t["default"]=o.a}},[["d8ed","common/runtime","common/vendor"]]]);